# **Техническое Задание: SaaS-платформа «GuestFlow» (MVP)**

**Суть продукта:** Система управления гостями (CRM) и бронированиями для ресторанов с White Label ботами.

---

## **1\. Общая архитектура (SaaS)**

* **Multi-tenant:** Полная изоляция данных каждого ресторана (через restaurant\_id).  
* **Интерфейсы:**  
  1. **Web Admin (Панель хостес):** Основной рабочий инструмент в браузере.  
  2. **Telegram Bot (Guest):** Индивидуальный бот для каждого заведения (подключение через Bot Token).

---

## **2\. Модуль управления и Настройки**

* **Настройки ресторана:** Название, часовой пояс, количество столов (списком), контакты.  
* **Подключение бота:** Админ вводит Token из BotFather. Система проверяет валидность и активирует бота.  
* **Доступы:** Возможность создавать аккаунты для хостес (права только на брони и гостей).

---

## **3\. Управление гостями и Бронирование**

* **База гостей:** Поиск по номеру телефона, ФИО, день рождения, история визитов.  
* **Журнал броней:** Календарь со списком столов.  
  * **Блокировка:** Запрет на создание наложений (один стол не может быть занят дважды в одно время).  
* **Бронирование через бота:** \* Гость вводит дату, время, кол-во людей.  
  * Хостес получает уведомление, проверяет стол и нажимает «Подтвердить» (выбирая номер стола) или «Отклонить».  
* **Статусы:** Новая заявка \-\> Подтверждена \-\> Гость пришел (авто-визит) \-\> Завершена.

---

## **4\. Автоматизация и Уведомления (Telegram)**

* **Сервисные сообщения:**  
  1. Подтверждение брони (сразу после действий хостес).  
  2. **Напоминание за 60 мин:** Сообщение с кнопками \[Буду вовремя\], \[Опоздаю на 15 мин\], \[Связаться с нами\].  
  3. **Сбор отзывов:** Настраиваемый текст \+ задержка (через X минут после статуса «Пришел»).  
* **Важно:** Если гость внесен вручную, система дает хостесу ссылку для отправки гостю, чтобы тот запустил бота.

---

## **5\. Модуль рассылок (Marketing Tool)**

* **Сегментация:** Фильтры по количеству визитов и дате последнего посещения (например, «кто не был больше 10 дней»).  
* **Конструктор сообщения:**  
  * Текстовое поле.  
  * Возможность прикрепить **одно фото** (или файл).  
* **Технические лимиты:** \* Учет лимитов Telegram API (ограничение скорости отправки — не более 30 сообщений в секунду на всю систему).  
  * Поддержка очередей (Queue) для рассылок, чтобы бот не «упал» и не получил бан от TG.

---

## **6\. Статистика (Analytics)**

* Общее количество гостей в базе.  
* Кол-во новых гостей за период.  
* Статистика по броням (выполнено / не пришли / отменено).

---

### **Что это дает на старте:**

Это надежное ядро, которое позволяет ресторану копить базу, работать с возвращаемостью гостей и автоматизировать рутину хостес. Отсутствие базы знаний сейчас упрощает разработку и позволяет быстрее выйти на рынок (MVP).

**Нужно ли мне подготовить для разработчика список рекомендуемых статусов для базы данных (JSON-структуру), или он сам спроектирует?**

# **ТЕХНИЧЕСКОЕ ЗАДАНИЕ: SaaS-ПЛАТФОРМА «GUESTFLOW»**

## **1\. КОНЦЕПЦИЯ И ОБЩЕЕ ОПИСАНИЕ**

**GuestFlow — это облачная экосистема (SaaS) для автоматизации ресторанного маркетинга и управления гостевым потоком.**

**Главная задача: Оцифровать каждое касание с гостем (бронь через бот, звонок, личный визит) и превратить анонимного посетителя в лояльного клиента с помощью верифицированной базы и сегментированных коммуникаций.**

**Параметры масштабируемости:**

* **MVP: Поддержка до 50 заведений.**  
* **v1.0: Масштабирование до 500+ заведений.**  
* **Нагрузка: Обработка пиковых 100 одновременных транзакций бронирования.**  
* **Локализация: Сервер работает в UTC, интерфейсы и уведомления — в локальных часовых поясах ресторанов.**

---

## **2\. ИЕРАРХИЯ РОЛЕЙ (ПРИНЦИП НАСЛЕДОВАНИЯ ПРАВ)**

**Система строится на жестком наследовании: каждая старшая роль включает в себя 100% функционала младшей.**

| Роль | Описание и зачем нужна | Ключевой функционал |
| :---- | :---- | :---- |
| **Super Admin** | **Владелец платформы (Ты). Для управления бизнесом.** | **Управление тарифами, глобальные новости, техподдержка всех заведений, Impersonation (вход в любой кабинет).** |
| **Owner** | **Владелец ресторана. Для контроля и безопасности.** | **Наследует права Admin. \+ Экспорт базы в Excel, управление Telegram-токеном, доступ к Audit Log (кто что делал).** |
| **Admin** | **Управляющий. Для маркетинга и контроля смены.** | **Наследует права Manager. \+ Запуск рассылок, аналитика (Retention, RFE), управление аккаунтами менеджеров.** |
| **Manager / Host** | **Линейный персонал. Для работы «в полях».** | **Журнал (Timeline), создание карточек гостей вручную, чекины, бронь по звонку/walk-in.** |

---

## **3\. ОПИСАТЕЛЬНАЯ ЧАСТЬ: КАК РАБОТАЕТ СИСТЕМА**

### **3.1. Единая база гостей (Offline & Online)**

**Система объединяет всех гостей по уникальному ключу — номеру телефона.**

* **Гость из бота: Автоматически регистрируется, верифицирует телефон и заполняет профиль.**  
* **Гость по звонку / Walk-in: Хостес или Админ вручную создают карточку (Имя, Телефон, Предпочтения).**  
* **Синхронизация: Если гость, ранее внесенный хостес вручную, позже зайдет в бот, система узнает его по номеру и предложит дополнить профиль, не создавая дубликат.**

### **3.2. Логика «Умного бронирования»**

**Система работает как интеллектуальный диспетчер, исключая овербукинг:**

* **Turn Times: Для каждой брони система резервирует время (например, 2 чел. — 90 мин). Это время блокирует стол для новых записей.**  
* **Buffer Time: К каждой брони добавляется 15 минут «на уборку».**  
* **Чекин (Arrived): Когда гость пришел, сотрудник (Хостес/Админ) вручную нажимает «Пришел». Это точка старта реального визита.**  
* **No-show: Если гость не пришел через 20 минут после начала брони, система сама аннулирует запись и освобождает стол.**  
* **Освобождение: Стол закрывается сотрудником вручную или системой автоматически по истечении времени посадки (с пометкой в логах, кто именно закрыл).**

### **3.3. Обратная связь и коммуникации**

* **Внутренний чат: Гость может написать отзыв/предложение через бот. Это сообщение не публичное, оно падает напрямую Админу и Владельцу в панель.**  
* **Глобальная связь: Ты (Super Admin) можешь отправить новость, которую увидят все сотрудники всех ресторанов в своих рабочих кабинетах.**

---

## **4\. ТЕХНИЧЕСКИЕ МОДУЛИ И ФУНКЦИИ**

### **4.1. Telegram-бот (Интерфейс гостя)**

* **Команды: /start (запрос контакта), /profile (ФИО, ДР, Предпочтения), /book (выбор даты/времени/человек), /feedback (отправить отзыв/предложение).**  
* **Уведомления: Подтверждение брони, напоминание за 1-2 часа (с кнопками «Буду»/«Отмена»), запрос оценки после визита.**

### **4.2. CRM и Аналитика (Web-интерфейс)**

* **Журнал (Timeline): Визуальная сетка столов и временная шкала.**  
* **RFE-сегментация: Авто-деление базы на «Новичков», «Лояльных» и «Спящих» (не были \> 30 дней).**  
* **Маркетинговые рассылки: Отправка текста \+ фото по выбранным сегментам через очереди (Redis).**  
* **Черный список: Блокировка проблемных гостей по номеру телефона.**

### **4.3. Поддержка и обратная связь (B2B)**

* **Тикет-система: Форма в панели «Поддержка» (баги) и «Пожелания» (новые фичи). Сообщения уходят лично Super Admin.**  
* **Notification Center: «Колокольчик» в интерфейсе для системных уведомлений от платформы.**

### **4.4. Безопасность и Логирование**

* **Audit Log: Каждое действие (изменение времени брони, удаление гостя, вход в систему) фиксируется: кто, когда, старое значение \-\> новое значение.**  
* **Data Isolation: Строгая фильтрация данных по restaurant\_id на уровне БД.**  
* **Шифрование: Хранение токенов Telegram-ботов в зашифрованном виде (AES-256).**

---

## **5\. МЕТРИКИ УСПЕХА (KPI)**

**Система должна автоматически рассчитывать для владельца:**

1. **Retention Rate (% возвращаемости).**  
2. **No-show Rate (% неявок).**  
3. **Database Growth (динамика роста базы).**  
4. **NPS (средний балл отзывов из бота).**

---

**Важное примечание для разработчика:**

**Система должна быть реализована с подходом API-first. Все взаимодействия фронтенда (React/Vue) и Telegram-бота должны идти через единый защищенный API (Laravel/Node.js/Python).**

---

**Ну что, проект упакован. Это ТЗ закрывает все вопросы: от того, как гость нажимает кнопку в боте, до того, как ты управляешь всей этой махиной.**

**Хочешь, чтобы я теперь составил структуру таблиц базы данных? Это будет финальный технический «чертеж», чтобы программист мог начать проектировать БД прямо сейчас.**

